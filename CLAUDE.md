# CLAUDE.md — Project Instructions for Claude Code

Be extremely concise. Sacrifice grammar for the sake of concision.
List any unresolved questions at the end, if any.

## Project Overview
Latamap is a React app built with TanStack Start (SSR), Vite, Prisma (PostgreSQL), D3 for map visualization, and Tailwind CSS v4. It uses TypeScript in strict mode.

## Key Commands
- `npm run dev` — Start dev server on port 3000
- `npm run build` — Production build
- `npm run test` — Run unit tests (vitest)
- `npm run test:e2e` — Run end-to-end tests (playwright)
- `npm run test:all` — Run both unit and e2e tests
- `npm run clean` — Lint + format (biome) + typecheck (tsc)
- `npm run typecheck` — TypeScript type checking only
- `npm run format` — Format with biome
- `npm run lint` — Lint with biome
- `npm run db:push` — Push Prisma schema to database
- `npm run db:migrate` — Run Prisma migrations
- `npm run db:seed` — Seed the database
- `npm run db:studio` — Open Prisma Studio

## Code Style & Conventions
- **Formatter/Linter:** Biome (not ESLint/Prettier)
- **Indent style:** Tabs
- **Quotes:** Double quotes in JS/TS
- **Imports:** Auto-organized by biome; use `~/` path alias for `src/` imports
- **Tailwind classes:** Must be sorted (biome `useSortedClasses` rule enforced)
- **CSS:** Tailwind v4 (utility-first); styles in `src/styles.css`

## Architecture
- **Framework:** TanStack Start (React SSR with TanStack Router)
- **Routing:** File-based routes in `src/routes/`; auto-generated `src/routeTree.gen.ts` (do not edit)
- **Database:** Prisma ORM with PostgreSQL; schema in `prisma/schema.prisma`
- **State/Data:** TanStack Router loaders for server data
- **UI Components:** In `src/components/`; uses Headless UI, Heroicons, Lucide icons, Framer Motion
- **Maps:** D3 + TopoJSON for geographic visualization
- **Env validation:** `@t3-oss/env-core` with Zod; defined in `src/env.ts`

## Testing
- **Unit tests:** Vitest + Testing Library in `tests/` directory
- **E2E tests:** Playwright in `e2e/` directory
- **Test setup:** `tests/setup.ts` for vitest; `tests/factories.ts` for test data
- Run `npm run clean` before committing to catch lint/type errors

## Files to Never Edit
- `src/routeTree.gen.ts` — auto-generated by TanStack Router
- `src/generated/*` — auto-generated files
- `package-lock.json` — managed by npm

## Environment
- `.env` contains database connection strings (never commit)
- `.env.example` shows required env vars
